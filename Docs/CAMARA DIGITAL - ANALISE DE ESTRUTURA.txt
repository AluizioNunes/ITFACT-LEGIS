# AN√ÅLISE COMPLETA DO SISTEMA CMM
## C√¢mara Municipal de Manaus - Sistema Proton

**Data da An√°lise:** 04 de fevereiro de 2026  
**Banco de Dados:** bd_cmm (SQL Server)  
**Aplica√ß√£o:** D:\inetpub\wwwroot\cmm\proton  

---

## üìä 1. AN√ÅLISE DAS 20 MAIORES TABELAS

### Ranking por Volume de Registros

| # | Schema | Tabela | Registros | Fun√ß√£o |
|---|--------|--------|-----------|--------|
| 1 | dbo | tbl_sistema_historico | 9.971.387 | Hist√≥rico de a√ß√µes do sistema |
| 2 | dbo | tbl_protocolo_movimento | 2.672.565 | Movimenta√ß√µes de protocolos |
| 3 | dbo | tbl_protocolo_visualizador | 1.558.930 | Controle de visualiza√ß√µes |
| 4 | dbo | tbl_sistema_log | 1.512.694 | Logs do sistema |
| 5 | dbo | tbl_protocolo_documento | 1.258.876 | **DOCUMENTOS (arquivos)** |
| 6 | dbo | tbl_protocolo_interessado | 640.751 | Interessados nos protocolos |
| 7 | dbo | tbl_protocolo | 636.972 | **PROTOCOLOS PRINCIPAIS** |
| 8 | dbo | tbl_protocolo_arquivo | 619.666 | **ARQUIVOS F√çSICOS** |
| 9 | dbo | tbl_documento_assinatura | 496.555 | **ASSINATURAS DIGITAIS** |
| 10 | dbo | tbl_protocolo_distribuicao | 427.003 | Distribui√ß√µes |
| 11 | dbo | tbl_protocolo_prazo_resposta | 361.146 | Prazos de resposta |
| 12 | dbo | tbl_propositura_legislativa_tramitacao | 309.301 | Tramita√ß√µes legislativas |
| 13 | dbo | tbl_propositura_legislativa_fase_historico | 307.419 | Hist√≥rico de fases |
| 14 | dbo | tbl_propositura_legislativa_documento | 279.762 | **DOCS LEGISLATIVOS** |
| 15 | dbo | tbl_protocolo_anexo | 265.197 | Anexos de protocolos |
| 16 | dbo | tbl_seg_usuario_perfil_funcao | 211.849 | Perfis de usu√°rios |
| 17 | dbo | tbl_pesquisa_arquivo_bkp | 163.438 | Backup de pesquisas |
| 18 | dbo | tbl_protocolo_assinatura | 157.888 | Assinaturas de protocolos |
| 19 | dbo | tbl_propositura_legislativa_anexo | 121.769 | Anexos legislativos |
| 20 | dbo | tbl_protocolo_fisico | 114.432 | Controle f√≠sico |

### Observa√ß√µes Cr√≠ticas:

‚úÖ **Total de protocolos:** 636.972 registros  
‚úÖ **Total de documentos/arquivos:** 1.258.876 + 619.666 = **1.878.542 arquivos**  
‚úÖ **Total de assinaturas digitais:** 496.555 + 157.888 = **654.443 assinaturas**  
‚úÖ **Sistema altamente movimentado:** 2,6 milh√µes de tramita√ß√µes  
‚úÖ **Sistema com auditoria completa:** 9,9 milh√µes de logs hist√≥ricos  

---

## üóÇÔ∏è 2. ESTRUTURA DA TABELA tbl_protocolo (49 COLUNAS)

### Colunas Principais (Identifica√ß√£o)

| Coluna | Tipo | Tamanho | Nullable | Default | Descri√ß√£o |
|--------|------|---------|----------|---------|-----------|
| cod_protocolo | int | - | NO | - | **PK - C√≥digo √∫nico** |
| txt_numero | varchar | 21 | NO | - | **N√∫mero do protocolo (NUP)** |
| txt_numero_anterior | varchar | 20 | YES | - | N√∫mero do sistema antigo |
| txt_referencia | varchar | 255 | YES | - | Refer√™ncia externa |
| txt_identificacao | varchar | 100 | YES | - | Identifica√ß√£o adicional |

### Colunas de Classifica√ß√£o

| Coluna | Tipo | Nullable | Default | Descri√ß√£o |
|--------|------|----------|---------|-----------|
| cod_protocolo_tipo | int | NO | 0 | Tipo do protocolo |
| cod_assunto | int | NO | 10000 | **Assunto principal** |
| cod_assunto_secundario | int | YES | - | Assunto secund√°rio |
| cod_documento_tipo | int | YES | - | Tipo de documento |
| cod_situacao | int | NO | 1 | **Situa√ß√£o atual** |

### Colunas de Datas

| Coluna | Tipo | Nullable | Default | Descri√ß√£o |
|--------|------|----------|---------|-----------|
| dt_abertura | datetime | NO | getdate() | Data de abertura |
| dt_protocolo | datetime | NO | getdate() | **Data do protocolo** |
| dt_recebimento | datetime | YES | - | Data de recebimento |
| dt_conformidade | datetime | YES | - | Data de conformidade |
| dt_prazo_resposta | datetime | YES | - | Prazo para resposta |
| dt_tramitacao | datetime | YES | - | √öltima tramita√ß√£o |
| dt_vencimento | datetime | YES | - | Data de vencimento |
| dt_resultado_analise | datetime | YES | - | Data de an√°lise |

### Colunas de Origem/Destino

| Coluna | Tipo | Nullable | Default | Descri√ß√£o |
|--------|------|----------|---------|-----------|
| cod_protocolo_origem | int | NO | 1 | Origem do protocolo |
| cod_orgao_demanda | int | YES | - | √ìrg√£o demandante |
| cod_orgao_atual | int | YES | 0 | **√ìrg√£o atual** |
| cod_orgao_atributo | int | YES | - | √ìrg√£o de atributo |

### Colunas de Controle

| Coluna | Tipo | Nullable | Default | Descri√ß√£o |
|--------|------|----------|---------|-----------|
| cod_internet | int | NO | 1 | Acesso internet |
| cod_suporte_tipo | int | YES | 0 | Tipo de suporte |
| cod_copia | int | NO | 0 | √â c√≥pia? |
| cod_copia_controlada | int | NO | 0 | C√≥pia controlada? |
| cod_recebimento | int | NO | 0 | C√≥digo de recebimento |
| cod_ativo | int | NO | 1 | **Ativo/Inativo** |
| cod_migrado | int | YES | 0 | Foi migrado? |
| cod_original | int | NO | 1 | √â original? |

### Colunas de Fluxo

| Coluna | Tipo | Nullable | Default | Descri√ß√£o |
|--------|------|----------|---------|-----------|
| cod_fluxo_ativo | int | YES | 0 | Fluxo ativo |
| cod_emprestimo_ativo | int | YES | 0 | Empr√©stimo ativo |
| cod_juntado_ativo | int | YES | 0 | Juntado ativo |
| cod_anexo | int | YES | - | Anexo |

### Colunas de Responsabilidade

| Coluna | Tipo | Nullable | Default | Descri√ß√£o |
|--------|------|----------|---------|-----------|
| cod_usuario_cuidado | int | YES | - | Usu√°rio respons√°vel |
| cod_usuario_responsavel | int | YES | - | Respons√°vel geral |
| cod_usuario_analise | int | YES | - | Usu√°rio que analisou |

### Colunas de Conte√∫do

| Coluna | Tipo | Tamanho | Nullable | Descri√ß√£o |
|--------|------|---------|----------|-----------|
| txt_resumo | text | 2GB | YES | **Resumo do protocolo** |
| txt_texto | text | 2GB | YES | Texto completo |

### Colunas de Localiza√ß√£o

| Coluna | Tipo | Tamanho | Nullable | Descri√ß√£o |
|--------|------|---------|----------|-----------|
| txt_localizacao_fisica | varchar | 255 | YES | Localiza√ß√£o f√≠sica |

### Colunas de Refer√™ncias Externas

| Coluna | Tipo | Tamanho | Nullable | Descri√ß√£o |
|--------|------|---------|----------|-----------|
| txt_referencia_os | varchar | 50 | YES | Refer√™ncia OS |
| txt_referencia_uc | varchar | 50 | YES | Refer√™ncia UC |
| txt_referencia_us | varchar | 50 | YES | Refer√™ncia US |
| txt_numero_projeto | varchar | 50 | YES | N√∫mero do projeto |

### Colunas de Controle Adicional

| Coluna | Tipo | Nullable | Default | Descri√ß√£o |
|--------|------|----------|---------|-----------|
| cod_protocolo_opcao | int | NO | 0 | Op√ß√µes do protocolo |
| cod_vistoria | int | YES | - | Vistoria relacionada |
| cod_prioridade | int | NO | 0 | Prioridade |
| cod_acesso_tipo | int | NO | - | **Tipo de acesso** |
| seq_carga_processo | int | YES | - | Sequ√™ncia de carga |

---

## üìÑ 3. P√ÅGINAS .ASPX DO SISTEMA (265 ARQUIVOS)

### Distribui√ß√£o por Funcionalidade

#### 3.1. INCLUS√ÉO DE PROTOCOLOS (16 p√°ginas)
- incluir_arquivo.aspx
- incluir_arquivo_minuta.aspx
- incluir_arquivo_multiplo.aspx
- incluir_assunto.aspx
- incluir_caixa.aspx
- incluir_concessao_consulta.aspx
- incluir_documento.aspx
- incluir_impressao.aspx
- incluir_interessado.aspx
- incluir_interessado_invalido.aspx
- incluir_interessado_orgao.aspx
- incluir_interessado_valido.aspx
- incluir_opcao.aspx
- incluir_palavra_chave.aspx
- incluir_pasta.aspx
- incluir_pre_despacho.aspx
- incluir_processo.aspx
- incluir_processo_autuado.aspx
- incluir_processo_passivo.aspx
- incluir_propositura.aspx
- incluir_protocolo.aspx
- incluir_protocolo_unico.aspx
- incluir_remetente.aspx
- incluir_usuario.aspx

#### 3.2. TRAMITA√á√ÉO (22 p√°ginas)
- tramitar.aspx
- movimentar.aspx
- movimentar_cancelar.aspx
- movimentar_cancelar_doc.aspx
- movimentar_copia.aspx
- distribuicao.aspx
- distribuicao_receber.aspx
- distribuicao_receber_doc.aspx
- receber.aspx
- receber_doc.aspx
- recebimento.aspx
- emprestar.aspx
- emprestimo_receber.aspx
- emprestimo_receber_doc.aspx
- guia.aspx
- guia_doc.aspx
- guia_tramitacao.aspx
- guia_tramitacao_doc.aspx
- guia_tramitacao_imprimir.aspx
- diligencia.aspx
- providenciar.aspx
- sobrestar.aspx

#### 3.3. MINUTAS (26 p√°ginas)
- minuta.aspx
- minuta_alterar.aspx
- minuta_arquivo.aspx
- minuta_associar_protocolo.aspx
- minuta_avaliacao.aspx
- minuta_avaliacao_finalizar.aspx
- minuta_avaliacao_imprimir.aspx
- minuta_avaliacao_incluir.aspx
- minuta_avaliacao_pessoal.aspx
- minuta_avaliar.aspx
- minuta_distribuicao_receber.aspx
- minuta_distribuir.aspx
- minuta_excluir.aspx
- minuta_historico.aspx
- minuta_imprimir.aspx
- minuta_incluir.aspx
- minuta_pesquisa_avancada.aspx
- minuta_receber.aspx
- minuta_recusar.aspx
- minuta_tramitar.aspx
- minuta_tramitar_cancelar.aspx
- minuta_versao.aspx

#### 3.4. ASSINATURA DIGITAL (15 p√°ginas)
- assinador.aspx
- assinador_arquivos_definicao.aspx
- assinador_login.aspx
- assinatura_definir.aspx
- assinatura_pessoal.aspx
- assinatura_recusa.aspx
- doc_assinatura_pessoal.aspx
- excluir_assinatura.aspx
- excluir_usuario_assinatura.aspx
- excluir_usuario_assinatura_legislativa.aspx
- listar_arquivo_assinatura.aspx
- listar_arquivo_assinatura_definicao.aspx
- ler_assinador.aspx
- ler_excluir_assinatura.aspx

#### 3.5. EXPEDI√á√ÉO (18 p√°ginas)
- expedicao.aspx
- expedicao_arquivo_digital.aspx
- expedicao_cancelar.aspx
- expedicao_digital.aspx
- expedicao_guia.aspx
- expedicao_guia_doc.aspx
- expedicao_guia_imprimir.aspx
- expedicao_guia_outros_protocolos.aspx
- expedicao_integracao.aspx
- expedicao_integracao_listagem.aspx
- expedicao_listar.aspx
- expedicao_opcao.aspx
- expedicao_protocolar.aspx
- expedicao_protocolar_processo.aspx
- expedicao_receber.aspx
- expedicao_receber_integracao.aspx

#### 3.6. PESQUISA (9 p√°ginas)
- pesquisa_simples.aspx
- pesquisa_simples_doc.aspx
- pesquisa_avancada.aspx
- pesquisa_avancada_doc.aspx
- pesquisa_arquivo_digital_bkp.aspx
- pesquisa_processo_concessao.aspx
- pesquisa_usuario_concessao.aspx

#### 3.7. RELAT√ìRIOS (30+ p√°ginas)
- relatorio_acompanhamento.aspx
- relatorio_arquivo_digital.aspx
- relatorio_arquivo_setorial.aspx
- relatorio_banco.aspx
- relatorio_banco_doc.aspx
- relatorio_classificacao.aspx
- relatorio_comentario.aspx
- relatorio_controle_prazo.aspx
- relatorio_controle_prazo_doc.aspx
- relatorio_destinatario.aspx
- relatorio_documentos_assinados.aspx
- relatorio_documentos_tramitados.aspx
- relatorio_expedicao.aspx
- relatorio_expedicao_digital.aspx
- relatorio_expedicao_externa.aspx
- relatorio_expedicao_integracao.aspx
- relatorio_juntada.aspx
- relatorio_minuta.aspx
- relatorio_nao_distribuido.aspx
- relatorio_nao_recebidos.aspx
- relatorio_nao_recebido_gerencial.aspx
- relatorio_palavra.aspx
- relatorio_prazo_guarda.aspx
- relatorio_prazo_resposta.aspx
- relatorio_producao.aspx
- relatorio_producao_doc.aspx
- relatorio_recebimento.aspx
- relatorio_sobrestar.aspx
- relatorio_sobrestar_doc.aspx
- relatorio_suporte.aspx
- relatorio_tramitacao.aspx
- relatorio_tramitacao_doc.aspx
- relatorio_tramitacao_estatistico.aspx
- relatorio_unidade.aspx

#### 3.8. VISUALIZA√á√ÉO E IMPRESS√ÉO (16 p√°ginas)
- ler.aspx
- ler_arq_original.aspx
- detalhamento.aspx
- historico.aspx
- impressao.aspx
- impressao_arquivo.aspx
- impressao_arquivo_assinatura.aspx
- impressao_arquivo_concessao.aspx
- impressao_arquivo_contador.aspx
- impressao_arquivo_controle.aspx
- impressao_arquivo_esquerdo.aspx
- impressao_processo.aspx
- impressao_processo_concessao.aspx
- impressao_restrito.aspx
- capa.aspx
- capa_processo.aspx
- ficha.aspx
- ficha_despacho.aspx

#### 3.9. GEST√ÉO DOCUMENTAL (12 p√°ginas)
- anexar.aspx
- anexar_doc.aspx
- anexar_doc_listagem.aspx
- anexar_doc_propositura.aspx
- apensar.aspx
- arquivar.aspx
- eliminar.aspx
- eliminar_imprimir.aspx
- eliminar_incluir.aspx
- eliminar_listar.aspx
- vinculacao.aspx
- volume.aspx

#### 3.10. COMUNICA√á√ÉO (10 p√°ginas)
- comunicacao_electronica.aspx
- comunicacao_electronica_detalhar.aspx
- comunicacao_electronica_detalhar_usuario.aspx
- comunicacao_electronica_detalhar_usuario_doc.aspx
- comunicacao_electronica_listar.aspx
- comunicacao_electronica_listar_usuario.aspx
- comunicacao_electronica_listar_usuario_doc.aspx
- consulta_publica.aspx
- consulta_publica_detalhar.aspx
- consulta_publica_resultado.aspx

#### 3.11. CONTROLES ESPEC√çFICOS (15 p√°ginas)
- acompanhar.aspx
- alterar.aspx
- alterar_processo.aspx
- cancelar.aspx
- comentario.aspx
- controle_prazo.aspx
- prazo_resposta.aspx
- prazo_resposta_doc.aspx
- check_list.aspx
- etiqueta.aspx
- gerar_etiqueta.aspx
- responsavel.aspx
- validacao.aspx
- pauta.aspx
- original.aspx

#### 3.12. UTILIT√ÅRIOS (10 p√°ginas)
- CodigoBarra.aspx
- Criptografia.aspx
- exportar_excel.aspx
- upload.aspx
- ftp.aspx
- pdf_consolidar.aspx
- calcula_expedicao.aspx

#### 3.13. CASOS ESPEC√çFICOS (8 p√°ginas)
- aposentadoria.aspx
- pensao.aspx
- dotacao_orcamentaria.aspx
- concessao_consultar.aspx
- palavra_chave.aspx
- publicacao.aspx
- pre_protocolo.aspx
- informar_andamento_propositura.aspx

#### 3.14. LISTAGENS (10 p√°ginas)
- listagem.aspx
- listagem_concessao.aspx
- listagem_doc.aspx
- listar_arquivado.aspx
- listar_permanente.aspx
- resultado_interessado.aspx

#### 3.15. C√ìPIAS (2 p√°ginas)
- copia_excluir.aspx
- copia_incluir.aspx

**TOTAL: 265 arquivos .aspx**

---

## ‚öôÔ∏è 4. CONFIGURA√á√ïES DO WEB.CONFIG

### 4.1. Seguran√ßa e Criptografia

```xml
<appSettings>
    <add key="txt_criptogafia_chave" value="Gr4_41rp0rT" />
    <add key="txt_criptogafia_salt" value="pr8t8n1kh8n" />
    <add key="AppId" value="20" />
</appSettings>
```

**‚ö†Ô∏è CR√çTICO:** Chaves de criptografia expostas em texto plano!

### 4.2. Connection Strings

```xml
<connectionStrings>
    <add name="ProtonConnectionString" 
         providerName="System.Data.SqlClient" 
         connectionString="Data Source=(local);
                          Initial Catalog=bd_cmm;
                          Persist Security Info=True;
                          User ID=iusr_cmm;
                          Password=ProtonCmm4321;
                          Connection Timeout=30;
                          MultipleActiveResultSets=True" />
    
    <add name="ProtonOleDB" 
         providerName="System.Data.OleDb" 
         connectionString="Provider=SQLOLEDB.1;
                          Data Source=(local);
                          Initial Catalog=bd_cmm;
                          Persist Security Info=True;
                          User ID=iusr_cmm;
                          Password=ProtonCmm4321;
                          Connection Timeout=30" />
</connectionStrings>
```

**Dados de Conex√£o:**
- **Servidor:** (local)
- **Banco:** bd_cmm
- **Usu√°rio:** iusr_cmm
- **Senha:** ProtonCmm4321
- **MARS:** Habilitado

### 4.3. URLs e Integra√ß√µes

```xml
<add key="url" value="http://cd02.cmm.am.gov.br/proton/proton/" />
<add key="txt_url_verificacao_documento" value="https://cd02.cmm.am.gov.br/verificador" />
<add key="txt_url_verificacao_usuario_externo" value="https://cd02.cmm.am.gov.br/proton/proton/UsuarioExterno" />
<add key="sessaoPlenariaApiUrl" value="https://expedienteh.cmm.am.gov.br/api/ikon-services"/>
<add key="sessaoPlenariaApiToken" value="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."/>
```

**‚ö†Ô∏è CR√çTICO:** Token JWT exposto em texto plano!

### 4.4. Configura√ß√µes do Sistema

```xml
<add key="ambiente" value="teste" />
<add key="termo_copia" value="C√ìPIA" />
<add key="DebugLoggingEnabled" value="true" />
<add key="LogPath" value="~/proton/imagemprocesso/Logs" />
<add key="RepositoryPath" value="~/" />
<add key="diretorioUploadFotosParlamentares" value="~/proton/images/temp/uploads/" />
<add key="legislativo-palamentar-cargo" value="VEREADOR(A)"/>
```

### 4.5. ASP.NET Settings

```xml
<httpRuntime maxRequestLength="2097151"        <!-- 2GB -->
             executionTimeout="2400"           <!-- 40 minutos -->
             requestPathInvalidCharacters="" 
             relaxedUrlToFileSystemMapping="true" 
             requestValidationMode="2.0" />

<customErrors mode="Off" />                    <!-- ‚ö†Ô∏è Modo debug em produ√ß√£o! -->

<sessionState timeout="120" />                 <!-- 2 horas -->
```

### 4.6. Membership Provider

```xml
<membership defaultProvider="CSLIB_MembershipProvider" 
            userIsOnlineTimeWindow="15">
    <providers>
        <add name="CSLIB_MembershipProvider" 
             type="CSLIB.UserManager.CSLIB_MembershipProvider, CSLIB.UserManager" 
             applicationName="Eproton" 
             enablePasswordRetrieval="false" 
             enablePasswordReset="false" 
             requiresQuestionAndAnswer="false" 
             requiresUniqueEmail="false" 
             passwordFormat="Hashed" 
             applicationid="20" 
             PasswordStrengthRegEx="*" />
    </providers>
</membership>
```

### 4.7. Machine Key

```xml
<machineKey validationKey="938D5CD846EE2473F74142CE75D1841A95440A6B702B7F55E2FF4440CB701A1B1B0BFA82E8279CC5703CCFCB614F30EFBB4278773EA35F15D97D33E7C4FAB300" 
            decryptionKey="ABBC21530988F61CC3A7A5EFC2FBCABD269718FA5CA7354D8C532EDAD8818A26" 
            validation="SHA1" 
            decryption="AES" />
```

**‚ö†Ô∏è CR√çTICO:** Machine key exposta!

### 4.8. WebDAV Configuration

```xml
<httpHandlers>
    <add path="*" verb="OPTIONS,PROPFIND" type="proton.WebDAVServerImpl.DavHandler" />
</httpHandlers>

<httpModules>
    <add name="ITHitPutUploadProgressAndResumeModule" 
         type="ITHit.WebDAV.Server.ResumableUpload.PutUploadProgressAndResumeModule, ITHit.WebDAV.Server" />
    <add name="ITHitPostUploadProgressModule" 
         type="ITHit.WebDAV.Server.PostUploadProgressModule, ITHit.WebDAV.Server" />
</httpModules>

<location path="proton/imagemprocesso/minuta">
    <system.web>
        <httpRuntime executionTimeout="2400" 
                     maxRequestLength="2097151" 
                     requestPathInvalidCharacters="" 
                     relaxedUrlToFileSystemMapping="true" />
    </system.web>
</location>
```

### 4.9. CORS Configuration

```xml
<httpProtocol>
    <customHeaders>
        <add name="Access-Control-Allow-Origin" value="*" />
    </customHeaders>
</httpProtocol>
```

**‚ö†Ô∏è CR√çTICO:** CORS totalmente aberto!

---

## üìö 5. DLLs DO SISTEMA (46 BIBLIOTECAS)

### 5.1. DLLs Propriet√°rias (Ikhon - 12 DLLs)

| DLL | Fun√ß√£o Prov√°vel |
|-----|-----------------|
| **Ikhon.ePROTON.Intranet.dll** | Interface Web Principal |
| **Ikhon.ePROTON.Repositorio.dll** | Camada de Acesso a Dados (DAL) |
| **Ikhon.ePROTON.Regra.dll** | Regras de Neg√≥cio (BLL) |
| **Ikhon.ePROTON.Modelo.dll** | Entidades e Models |
| **Ikhon.ePROTON.Fachada.dll** | Fachada/API P√∫blica |
| **Ikhon.ePROTON.Infra.Core.dll** | Infraestrutura Core |
| **Ikhon.ePROTON.Apresentacao.dll** | Camada de Apresenta√ß√£o |
| **Ikhon.ePROTON.Utils.dll** | Utilit√°rios |
| **Ikhon.ePROTON.WebDav.dll** | Implementa√ß√£o WebDAV |
| **Ikhon.ePROTON.ContextoDB.dll** | Contexto Entity Framework |
| **Ikhon.ePROTON.Seguranca.dll** | Seguran√ßa/Autentica√ß√£o |
| **Ikhon.ePROTON.Data.dll** | Acesso a Dados Base |

### 5.2. Framework e ORM (4 DLLs)

| DLL | Vers√£o/Info | Fun√ß√£o |
|-----|-------------|--------|
| EntityFramework.dll | 6.x | ORM Principal |
| EntityFramework.SqlServer.dll | 6.x | Provider SQL Server |
| Dapper.dll | - | Micro-ORM |
| LinqKit.dll | - | Extens√µes LINQ |

### 5.3. Documentos e PDFs (14 DLLs)

| DLL | Fun√ß√£o |
|-----|--------|
| **itext.kernel.dll** | Core iText 7 |
| **itext.layout.dll** | Layout iText 7 |
| **itext.io.dll** | I/O iText 7 |
| **itext.forms.dll** | Formul√°rios PDF |
| **itext.sign.dll** | Assinatura PDF |
| **itext.pdfa.dll** | PDF/A |
| **itext.barcodes.dll** | C√≥digos de barra |
| **itext.styledxmlparser.dll** | Parser XML |
| **itext.svg.dll** | SVG |
| **itextsharp.dll** | iText 5 (legado) |
| **Spire.Pdf.dll** | Spire PDF |
| **Spire.Doc.dll** | Spire Word |
| **Spire.License.dll** | Licen√ßa Spire |
| **DocumentFormat.OpenXml.dll** | Office Open XML |

### 5.4. Assinatura Digital (5 DLLs)

| DLL | Fun√ß√£o |
|-----|--------|
| **Lacuna.Pki.dll** | ICP-Brasil PKI |
| **Lacuna.T8.dll** | Lacuna T8 |
| **BouncyCastle.Crypto.dll** | Criptografia |
| **ikcAssinatura.dll** | Assinatura customizada |
| **System.Security.dll** | Seguran√ßa .NET |

### 5.5. Planilhas e Excel (1 DLL)

| DLL | Fun√ß√£o |
|-----|--------|
| EPPlus.dll | Gera√ß√£o Excel |

### 5.6. WebDAV (1 DLL)

| DLL | Fun√ß√£o |
|-----|--------|
| ITHit.WebDAV.Server.dll | Servidor WebDAV |

### 5.7. Frameworks Auxiliares (5 DLLs)

| DLL | Fun√ß√£o |
|-----|--------|
| CSLIB.dll | Framework customizado |
| CSLIB.UserManager.dll | Gest√£o de usu√°rios |
| CSLIB_URLoginControl.dll | Controle de login |
| Common.Logging.dll | Logging abstrato |
| Common.Logging.Core.dll | Core logging |

### 5.8. Utilit√°rios (4 DLLs)

| DLL | Fun√ß√£o |
|-----|--------|
| Newtonsoft.Json.dll | Serializa√ß√£o JSON |
| log4net.dll | Logging |
| BarcodeLib.dll | C√≥digos de barra |
| Microsoft.mshtml.dll | HTML parsing |

**TOTAL: 46 DLLs**

---

## üéØ 6. AN√ÅLISE CR√çTICA PARA MIGRA√á√ÉO

### 6.1. Pontos Fortes do Sistema Atual

‚úÖ **Arquitetura em Camadas**
- Separa√ß√£o clara: Apresenta√ß√£o ‚Üí Fachada ‚Üí Regra ‚Üí Reposit√≥rio ‚Üí Modelo
- Facilita entendimento e migra√ß√£o

‚úÖ **Banco de Dados Robusto**
- 636.972 protocolos
- 1.878.542 documentos/arquivos
- Auditoria completa (9,9M registros hist√≥ricos)

‚úÖ **Funcionalidades Completas**
- 265 p√°ginas .aspx
- Sistema muito maduro
- Todas as opera√ß√µes de protocolo/tramita√ß√£o

‚úÖ **Assinatura Digital ICP-Brasil**
- 654.443 assinaturas registradas
- Lacuna PKI implementado
- PDF/A compliant

### 6.2. Desafios para Migra√ß√£o

üî¥ **CR√çTICO - Seguran√ßa**
- Credenciais em texto plano
- Chaves de criptografia expostas
- JWT token exposto
- Machine key exposta
- CORS totalmente aberto
- Custom errors desabilitado
- Debug mode em produ√ß√£o

üî¥ **CR√çTICO - Tecnologia Obsoleta**
- .NET Framework 4.0 (2010)
- ASP.NET WebForms (tecnologia descontinuada)
- VB.NET em algumas DLLs
- iText 5 + iText 7 (duplica√ß√£o)
- Entity Framework 6.x (n√£o √© EF Core)

üü° **ATEN√á√ÉO - Complexidade**
- 265 p√°ginas .aspx para migrar
- L√≥gica espalhada em code-behind
- ViewState e PostBack (WebForms)
- M√∫ltiplas bibliotecas PDF
- WebDAV implementa√ß√£o customizada

üü° **ATEN√á√ÉO - Volume de Dados**
- 1,8 milh√µes de arquivos para migrar
- 9,9 milh√µes de logs hist√≥ricos
- Estrutura de arquivos em Z:\ e G:\
- Nomenclatura de arquivos complexa

### 6.3. Estrat√©gia de Migra√ß√£o Recomendada

#### FASE 1: An√°lise e Planejamento
1. ‚úÖ Decompila√ß√£o de todas as DLLs (ILSpy)
2. ‚úÖ Mapeamento completo do banco de dados
3. ‚úÖ An√°lise de depend√™ncias
4. ‚úÖ Documenta√ß√£o de regras de neg√≥cio
5. ‚è≥ Defini√ß√£o de arquitetura alvo

#### FASE 2: Prepara√ß√£o
1. Criar estrutura .NET 8
2. Migrar entidades (Modelo)
3. Criar reposit√≥rios (Dapper ou EF Core)
4. Implementar regras de neg√≥cio
5. Criar APIs REST

#### FASE 3: Migra√ß√£o Incremental
1. **M√≥dulo 1:** Pesquisa/Consulta (read-only)
2. **M√≥dulo 2:** Inclus√£o de protocolos
3. **M√≥dulo 3:** Tramita√ß√£o
4. **M√≥dulo 4:** Minutas
5. **M√≥dulo 5:** Assinatura digital
6. **M√≥dulo 6:** Relat√≥rios

#### FASE 4: Migra√ß√£o de Dados
1. Scripts de migra√ß√£o de arquivos
2. Valida√ß√£o de integridade
3. Testes de carga
4. Rollback plan

#### FASE 5: Homologa√ß√£o e Go-Live
1. Testes integrados
2. Treinamento de usu√°rios
3. Cutover planejado
4. Suporte p√≥s-implanta√ß√£o

---

## üìã 7. CHECKLIST DE PR√ìXIMOS PASSOS

### An√°lise de C√≥digo (ILSpy)
- [ ] Decompila√ß√£o de Ikhon.ePROTON.Modelo.dll
- [ ] Decompila√ß√£o de Ikhon.ePROTON.Repositorio.dll
- [ ] Decompila√ß√£o de Ikhon.ePROTON.Regra.dll
- [ ] Decompila√ß√£o de Ikhon.ePROTON.Fachada.dll
- [ ] Decompila√ß√£o de Ikhon.ePROTON.Utils.dll
- [ ] Documenta√ß√£o de regras de neg√≥cio
- [ ] Extra√ß√£o de queries SQL

### Banco de Dados
- [ ] Script completo do schema
- [ ] Relacionamentos entre tabelas
- [ ] Stored procedures e functions
- [ ] Views existentes
- [ ] Triggers
- [ ] √çndices

### Arquivos
- [ ] Invent√°rio completo Z:\imagemprocesso
- [ ] Invent√°rio completo G:\sapl
- [ ] Scripts de valida√ß√£o de integridade
- [ ] Plano de migra√ß√£o de arquivos

### Arquitetura Nova Aplica√ß√£o
- [ ] Definir stack tecnol√≥gico
- [ ] Desenhar arquitetura
- [ ] Escolher framework frontend
- [ ] Definir estrat√©gia de APIs
- [ ] Plano de autentica√ß√£o/autoriza√ß√£o

---

## üöÄ 8. RECOMENDA√á√ïES T√âCNICAS

### Stack Recomendado para Nova Aplica√ß√£o

**Backend:**
- .NET 8 (LTS)
- ASP.NET Core Web API
- Entity Framework Core 8
- Dapper (queries otimizadas)
- MediatR (CQRS)
- FluentValidation

**Frontend:**
- React 18+ ou Angular 17+
- TypeScript
- Tailwind CSS
- React Query ou TanStack Query
- Zustand ou Redux Toolkit

**Banco de Dados:**
- SQL Server 2022
- Migra√ß√µes com FluentMigrator ou EF Core Migrations

**Assinatura Digital:**
- Lacuna PKI (manter)
- iText 8 (vers√£o mais recente)

**Armazenamento:**
- Azure Blob Storage ou MinIO (S3-compatible)
- Manter estrutura de diret√≥rios atual como fallback

**Autentica√ß√£o:**
- Identity Server ou Azure AD B2C
- JWT tokens
- OAuth 2.0 / OpenID Connect

**Observabilidade:**
- Serilog
- Application Insights ou Seq
- Grafana + Prometheus

---

**Documento gerado em:** 04/02/2026  
**Pr√≥ximo passo:** Decompila√ß√£o de DLLs e gera√ß√£o de c√≥digo  
**Status:** Pronto para desenvolvimento